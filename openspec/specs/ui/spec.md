# ui Specification

## Purpose
定义当前移动端 MVP 的核心学习界面行为：首页入口、句子练习、阅读模式、播放设置、课程单元切换与学习进度持久化。

## Requirements
### Requirement: 首页必须自动决定学习入口

系统 MUST 在进入首页时优先恢复最近学习进度；若无法恢复则回退到可用本地课程的首句；若无可用课程则展示空态引导。

#### Scenario: 恢复最近学习成功
- **GIVEN** 本地存在可用课程且 `LearningResumeStore` 中的 `packageRoot/sentenceId` 仍有效
- **WHEN** 用户打开首页
- **THEN** 系统进入句子练习页并定位到该句

#### Scenario: 无有效进度时回退到首句
- **GIVEN** 最近学习进度不存在或已失效，且本地存在可用课程
- **WHEN** 用户打开首页
- **THEN** 系统进入首个可用课程的首句

#### Scenario: 无可用课程时展示空态
- **GIVEN** 本地没有可用课程
- **WHEN** 用户打开首页
- **THEN** 展示空态页面
- **AND** 提供“前往下载中心”入口

### Requirement: 句子练习页必须提供空课程引导

系统 MUST 在句子练习页检测到无可用句子数据时展示引导视图，并允许用户跳转下载中心。

#### Scenario: 句子列表为空
- **GIVEN** 当前课程加载结果为空
- **WHEN** 用户进入句子练习页
- **THEN** 显示空课程引导页
- **AND** 点击按钮后跳转下载中心

### Requirement: 播放设置必须以底部弹窗提供

系统 MUST 通过 bottom sheet 展示播放设置，而不是独立设置路由页。

#### Scenario: 从句子练习打开播放设置
- **GIVEN** 用户在句子练习页
- **WHEN** 用户点击设置按钮
- **THEN** 打开播放设置 bottom sheet

#### Scenario: 从阅读模式打开播放设置
- **GIVEN** 用户在阅读模式页
- **WHEN** 用户点击设置按钮
- **THEN** 打开播放设置 bottom sheet

### Requirement: 播放设置必须支持语速切换

系统 MUST 提供 `0.5x`、`0.75x`、`1.0x` 三档语速，并在当前会话中立即生效。

#### Scenario: 切换到 0.75x
- **GIVEN** 当前语速为 `1.0x`
- **WHEN** 用户点击 `0.75x`
- **THEN** 语速状态更新为 `0.75x`
- **AND** 当前播放链路按新语速执行

### Requirement: 播放设置必须支持字幕与显示策略

系统 MUST 支持英文字幕开关、中文字幕开关、默认模糊译文，以及字幕大小调节。

#### Scenario: 关闭中文字幕
- **GIVEN** 中文字幕处于开启
- **WHEN** 用户关闭“显示译文”开关
- **THEN** 中文字幕在练习界面隐藏

#### Scenario: 调整字幕大小
- **GIVEN** 字幕大小为默认值
- **WHEN** 用户拖动“字幕大小”滑杆
- **THEN** 字幕大小按新值更新

### Requirement: 播放设置必须支持播放完成策略和自动录音

系统 MUST 提供播放完成策略选择（单元循环、课程循环、播放完暂停、所有课程循环）及自动录音开关。

#### Scenario: 切换播放完成策略
- **GIVEN** 当前策略为“课程循环”
- **WHEN** 用户切换到“播放完暂停”
- **THEN** 策略状态更新为“播放完暂停”

#### Scenario: 启用自动录音
- **GIVEN** 自动录音为关闭
- **WHEN** 用户开启“自动录音”
- **THEN** 自动录音状态更新为开启

### Requirement: 课程与单元切换必须可视化学习进度

系统 MUST 提供课程/单元选择弹窗，并展示课程与单元的练习次数、进度、熟练度与学习状态。

#### Scenario: 打开课程单元选择器
- **GIVEN** 用户在句子练习页
- **WHEN** 用户点击课程单元切换入口
- **THEN** 显示课程列表与单元列表
- **AND** 每个单元显示学习状态（未开始/学习中/已完成）

#### Scenario: 选择新单元后继续学习
- **GIVEN** 用户在选择器中选中目标单元
- **WHEN** 用户点击“继续学习”
- **THEN** 练习页切换到该单元首句

### Requirement: 学习进度与播放设置必须持久化

系统 MUST 将学习位置、课程练习指标、播放设置持久化，并在后续会话中恢复。

#### Scenario: 恢复最近学习位置
- **GIVEN** 用户完成过练习并保存了学习位置
- **WHEN** 用户重新进入应用首页
- **THEN** 系统尝试恢复到最近学习句子

#### Scenario: 恢复播放设置
- **GIVEN** 用户已修改语速或字幕设置
- **WHEN** 用户再次进入练习页面
- **THEN** 播放设置从本地存储恢复并生效
