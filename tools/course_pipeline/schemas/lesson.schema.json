{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "lesson.schema.json",
  "title": "Lesson",
  "type": "object",
  "required": ["lesson_id", "order", "title", "media", "sentences"],
  "properties": {
    "lesson_id": {"type": "string", "pattern": "^[0-9]{2}$"},
    "order": {"type": "integer", "minimum": 1},
    "title": {"type": "string", "minLength": 1},
    "media": {
      "type": "object",
      "required": ["type", "path"],
      "properties": {
        "type": {"type": "string", "enum": ["video", "audio"]},
        "path": {"type": "string", "minLength": 1},
        "duration_ms": {"type": "integer", "minimum": 0}
      },
      "additionalProperties": false
    },
    "subtitles": {
      "type": "object",
      "properties": {
        "en": {"type": "string"},
        "zh": {"type": "string"}
      },
      "additionalProperties": false
    },
    "sentences": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["sentence_id", "start_ms", "end_ms", "en", "zh", "ipa", "grammar", "usage", "status"],
        "properties": {
          "sentence_id": {"type": "string"},
          "start_ms": {"type": "integer", "minimum": 0},
          "end_ms": {"type": "integer", "minimum": 0},
          "en": {"type": "string", "minLength": 1},
          "zh": {"type": "string", "minLength": 1},
          "ipa": {"type": "string", "minLength": 1},
          "grammar": {
            "type": "object",
            "required": ["pattern"],
            "properties": {
              "pattern": {"type": "string", "minLength": 1},
              "points": {"type": "array", "items": {"type": "string"}},
              "difficulty": {"type": "string"}
            },
            "additionalProperties": false
          },
          "usage": {
            "type": "object",
            "required": ["scene"],
            "properties": {
              "scene": {"type": "string", "minLength": 1},
              "tone": {"type": "string"},
              "formality": {"type": "string"},
              "alternatives": {"type": "array", "items": {"type": "string"}},
              "caution": {"type": "string"}
            },
            "additionalProperties": false
          },
          "status": {
            "type": "object",
            "required": ["translation_ready", "ipa_ready", "grammar_ready", "usage_ready"],
            "properties": {
              "translation_ready": {"type": "boolean"},
              "ipa_ready": {"type": "boolean"},
              "grammar_ready": {"type": "boolean"},
              "usage_ready": {"type": "boolean"}
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
